
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   <!--
This HTML was auto-generated from MATLAB code.
To make changes, update the MATLAB code and republish this document.
      --><title>Task 2</title><meta name="generator" content="MATLAB 9.12"><link rel="schema.DC" href="http://purl.org/dc/elements/1.1/"><meta name="DC.date" content="2023-05-10"><meta name="DC.source" content="main.m"><style type="text/css">
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{margin:0;padding:0;border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent}body{line-height:1}ol,ul{list-style:none}blockquote,q{quotes:none}blockquote:before,blockquote:after,q:before,q:after{content:'';content:none}:focus{outine:0}ins{text-decoration:none}del{text-decoration:line-through}table{border-collapse:collapse;border-spacing:0}

html { min-height:100%; margin-bottom:1px; }
html body { height:100%; margin:0px; font-family:Arial, Helvetica, sans-serif; font-size:10px; color:#000; line-height:140%; background:#fff none; overflow-y:scroll; }
html body td { vertical-align:top; text-align:left; }

h1 { padding:0px; margin:0px 0px 25px; font-family:Arial, Helvetica, sans-serif; font-size:1.5em; color:#d55000; line-height:100%; font-weight:normal; }
h2 { padding:0px; margin:0px 0px 8px; font-family:Arial, Helvetica, sans-serif; font-size:1.2em; color:#000; font-weight:bold; line-height:140%; border-bottom:1px solid #d6d4d4; display:block; }
h3 { padding:0px; margin:0px 0px 5px; font-family:Arial, Helvetica, sans-serif; font-size:1.1em; color:#000; font-weight:bold; line-height:140%; }

a { color:#005fce; text-decoration:none; }
a:hover { color:#005fce; text-decoration:underline; }
a:visited { color:#004aa0; text-decoration:none; }

p { padding:0px; margin:0px 0px 20px; }
img { padding:0px; margin:0px 0px 20px; border:none; }
p img, pre img, tt img, li img, h1 img, h2 img { margin-bottom:0px; }

ul { padding:0px; margin:0px 0px 20px 23px; list-style:square; }
ul li { padding:0px; margin:0px 0px 7px 0px; }
ul li ul { padding:5px 0px 0px; margin:0px 0px 7px 23px; }
ul li ol li { list-style:decimal; }
ol { padding:0px; margin:0px 0px 20px 0px; list-style:decimal; }
ol li { padding:0px; margin:0px 0px 7px 23px; list-style-type:decimal; }
ol li ol { padding:5px 0px 0px; margin:0px 0px 7px 0px; }
ol li ol li { list-style-type:lower-alpha; }
ol li ul { padding-top:7px; }
ol li ul li { list-style:square; }

.content { font-size:1.2em; line-height:140%; padding: 20px; }

pre, code { font-size:12px; }
tt { font-size: 1.2em; }
pre { margin:0px 0px 20px; }
pre.codeinput { padding:10px; border:1px solid #d3d3d3; background:#f7f7f7; }
pre.codeoutput { padding:10px 11px; margin:0px 0px 20px; color:#4c4c4c; }
pre.error { color:red; }

@media print { pre.codeinput, pre.codeoutput { word-wrap:break-word; width:100%; } }

span.keyword { color:#0000FF }
span.comment { color:#228B22 }
span.string { color:#A020F0 }
span.untermstring { color:#B20000 }
span.syscmd { color:#B28C00 }
span.typesection { color:#A0522D }

.footer { width:auto; padding:10px 0px; margin:25px 0px 0px; border-top:1px dotted #878787; font-size:0.8em; line-height:140%; font-style:italic; color:#878787; text-align:left; float:none; }
.footer p { margin:0px; }
.footer a { color:#878787; }
.footer a:hover { color:#878787; text-decoration:underline; }
.footer a:visited { color:#878787; }

table th { padding:7px 5px; text-align:left; vertical-align:middle; border: 1px solid #d6d4d4; font-weight:bold; }
table td { padding:7px 5px; text-align:left; vertical-align:top; border:1px solid #d6d4d4; }





  </style></head><body><div class="content"><h1>Task 2</h1><!--introduction--><p>Analysis of piloted airplaine stability.</p><!--/introduction--><h2>Contents</h2><div><ul><li><a href="#1">Transfer function</a></li><li><a href="#4">Step response and stability</a></li><li><a href="#6">Propotional control transfer function</a></li><li><a href="#7">We can plot the poles of this system as a function of the proportional gain</a></li><li><a href="#9">Kp-stable values</a></li><li><a href="#13">Control system step response</a></li></ul></div><h2 id="1">Transfer function</h2><p>the transfer function, with canard deflection as input and pitch altitude as output, is given as:</p><p><img src="main_eq09030476675219268099.png" alt="$$ \frac{\theta}{\delta_c} = \frac{s+24}{(s-8)(s-18)} $$"></p><p>This system is clearly unstable, as both poles are positive real numbers (8 and 18) \\ We can verify this by using pzplot and looking at the poles:</p><pre class="codeinput">s = tf(<span class="string">'s'</span>);
sys = (s+24)/((s-8)*(s-18));
pzplot(sys);
</pre><img vspace="5" hspace="5" src="main_01.png" alt=""> <p>As we can see, both poles have positive real part, so the system must be unstable</p><h2 id="4">Step response and stability</h2><pre class="codeinput">close;
step(sys);
</pre><img vspace="5" hspace="5" src="main_02.png" alt=""> <p>The output of our system blows up to infinity, so it is clearly unstable.</p><p>The open-loop system does not satisfy BIBO, and requires closed loop control to become stable.</p><h2 id="6">Propotional control transfer function</h2><p>We add a proportional control and find an equivalent transfer function for the whole system. I use the block diagram to help express the new system.</p><pre class="codeinput">close;

s = tf(<span class="string">'s'</span>);
H = (s + 24)/((s-8)*(s-18));  <span class="comment">% The plant</span>
Kp = -5;  <span class="comment">% The proportional gain</span>

closed_loop = (Kp*s+Kp*24)/(s^2+(Kp-26)*s+(144+24*Kp));
pole(closed_loop)
</pre><pre class="codeoutput">
ans =

   30.2054
    0.7946

</pre><h2 id="7">We can plot the poles of this system as a function of the proportional gain</h2><p>we need to plot the roots of the polynomial:</p><p><img src="main_eq16903915959278760044.png" alt="$$ s^2+(Kp-26)s+(144+24)Kp $$"></p><pre class="codeinput">close;

Kp = -50:0.05:40;
s_1 = (-(Kp-26)+sqrt((Kp-26).^2-4*(144+24.*Kp)))/2;
s_2 = (-(Kp-26)-sqrt((Kp-26).^2-4*(144+24.*Kp)))/2;

figure;

subplot(2,1,1);
grid <span class="string">on</span>;
hold <span class="string">on</span>;
plot(Kp, real(s_1), <span class="string">'DisplayName'</span>, <span class="string">'Root 1'</span>, <span class="string">'LineStyle'</span>, <span class="string">'-'</span>);
plot(Kp, real(s_2), <span class="string">'DisplayName'</span>, <span class="string">'Root 2'</span>, <span class="string">'LineStyle'</span>, <span class="string">'--'</span>);
plot(Kp, zeros(size(Kp)), <span class="string">'k'</span>, <span class="string">'LineWidth'</span>, 1);  <span class="comment">% x-axis</span>
xlabel(<span class="string">'Kp'</span>); ylabel(<span class="string">'Real Part of Roots'</span>);
title(<span class="string">'Real part of poles'</span>);
legend;

subplot(2,1,2);
grid <span class="string">on</span>;
hold <span class="string">on</span>;
plot(Kp, imag(s_1), <span class="string">'DisplayName'</span>, <span class="string">'Root 1'</span>, <span class="string">'LineStyle'</span>, <span class="string">'-'</span>);
plot(Kp, imag(s_2), <span class="string">'DisplayName'</span>, <span class="string">'Root 2'</span>, <span class="string">'LineStyle'</span>, <span class="string">'--'</span>);
plot(Kp, zeros(size(Kp)), <span class="string">'k'</span>, <span class="string">'LineWidth'</span>, 1);  <span class="comment">% x-axis</span>
xlabel(<span class="string">'Kp'</span>); ylabel(<span class="string">'Imaginary Part of Roots'</span>);
title(<span class="string">'Imaginary part of poles'</span>);
legend;
</pre><img vspace="5" hspace="5" src="main_03.png" alt=""> <h2 id="9">Kp-stable values</h2><p>From inspecting the plot we see that both poles have negative real part when <img src="main_eq07821468769698417511.png" alt="$K_p &gt;26$">.</p><p>We can also see that <img src="main_eq09387732633226496302.png" alt="$Kp \approx 147$"> gives us optimal poles.</p><pre class="codeinput">close;
figure;
grid <span class="string">on</span>;
hold <span class="string">on</span>;

Kp = 144:0.05:150;
s_1 = (-(Kp-26)+sqrt((Kp-26).^2-4*(144+24.*Kp)))/2;
s_2 = (-(Kp-26)-sqrt((Kp-26).^2-4*(144+24.*Kp)))/2;
plot(Kp, real(s_1), <span class="string">'DisplayName'</span>, <span class="string">'Root 1'</span>, <span class="string">'LineStyle'</span>, <span class="string">'-'</span>);
plot(Kp, real(s_2), <span class="string">'DisplayName'</span>, <span class="string">'Root 2'</span>, <span class="string">'LineStyle'</span>, <span class="string">'--'</span>);
xlabel(<span class="string">'Kp'</span>); ylabel(<span class="string">'Real Part of Roots'</span>);
title(<span class="string">'Optimal poles'</span>);
legend;
</pre><img vspace="5" hspace="5" src="main_04.png" alt=""> <p>Verifying that Kp = 26 gives zero-poles</p><pre class="codeinput">close;
Kp = 26;
closed_loop = (Kp*s+Kp*24)/(s^2+(Kp-26)*s+(144+24*Kp));
real(pole(closed_loop))
</pre><pre class="codeoutput">
ans =

     0
     0

</pre><p>looking at the pole values for our new controller with <img src="main_eq05930565853247891489.png" alt="$Kp = 147$"></p><pre class="codeinput">Kp = 147;
closed_loop = (Kp*s+Kp*24)/(s^2+(Kp-26)*s+(144+24*Kp));
real(pole(closed_loop))
</pre><pre class="codeoutput">
ans =

  -60.5000
  -60.5000

</pre><pre class="codeinput">close;
pzplot(closed_loop);
</pre><img vspace="5" hspace="5" src="main_05.png" alt=""> <h2 id="13">Control system step response</h2><p>We have verified that the poles of our new system are all negative real part. This means the system stable, and we can verify this by viewing the step response of the closed loop system:</p><pre class="codeinput">[y,t]=step(closed_loop); <span class="comment">%save the output values to check steady state</span>
SS_error = abs(1-y(end))
</pre><pre class="codeoutput">
SS_error =

    0.0389

</pre><p>Thus we have verified that our control system is stable and reaches a steady state error of 3.89% We can also check that our simulink model agrees with our matlab simulations (see images).</p><p class="footer"><br><a href="https://www.mathworks.com/products/matlab/">Published with MATLAB&reg; R2022a</a><br></p></div><!--
##### SOURCE BEGIN #####
%% Task 2
% Analysis of piloted airplaine stability.

%% Transfer function
% the transfer function, with canard deflection as input and pitch altitude as output, is given as:
%%
% $$ \frac{\theta}{\delta_c} = \frac{s+24}{(s-8)(s-18)} $$
%
% This system is clearly unstable, as both poles are positive real numbers (8 and 18) \\
% We can verify this by using pzplot and looking at the poles:

s = tf('s');
sys = (s+24)/((s-8)*(s-18));
pzplot(sys);


%%
% As we can see, both poles have positive real part, so the system must be unstable

%% Step response and stability
close;
step(sys);

%% 
% The output of our system blows up to infinity, so it is clearly unstable.  
%
% The open-loop system does not satisfy BIBO, and requires closed loop control to become stable.

%% Propotional control transfer function
% We add a proportional control and find an equivalent transfer function for the whole system.
% I use the block diagram to help express the new system.
close;

s = tf('s');
H = (s + 24)/((s-8)*(s-18));  % The plant
Kp = -5;  % The proportional gain

closed_loop = (Kp*s+Kp*24)/(s^2+(Kp-26)*s+(144+24*Kp));
pole(closed_loop)
%% We can plot the poles of this system as a function of the proportional gain
% we need to plot the roots of the polynomial:
%%
% $$ s^2+(Kp-26)s+(144+24)Kp $$
%
close;

Kp = -50:0.05:40;
s_1 = (-(Kp-26)+sqrt((Kp-26).^2-4*(144+24.*Kp)))/2;
s_2 = (-(Kp-26)-sqrt((Kp-26).^2-4*(144+24.*Kp)))/2;

figure;

subplot(2,1,1);
grid on;
hold on;
plot(Kp, real(s_1), 'DisplayName', 'Root 1', 'LineStyle', '-');
plot(Kp, real(s_2), 'DisplayName', 'Root 2', 'LineStyle', 'REPLACE_WITH_DASH_DASH');
plot(Kp, zeros(size(Kp)), 'k', 'LineWidth', 1);  % x-axis
xlabel('Kp'); ylabel('Real Part of Roots');
title('Real part of poles');
legend;

subplot(2,1,2);
grid on;
hold on;
plot(Kp, imag(s_1), 'DisplayName', 'Root 1', 'LineStyle', '-');
plot(Kp, imag(s_2), 'DisplayName', 'Root 2', 'LineStyle', 'REPLACE_WITH_DASH_DASH');
plot(Kp, zeros(size(Kp)), 'k', 'LineWidth', 1);  % x-axis
xlabel('Kp'); ylabel('Imaginary Part of Roots');
title('Imaginary part of poles');
legend;




%% Kp-stable values
% From inspecting the plot we see that both poles have negative real part when $K_p >26$.
%
% We can also see that $Kp \approx 147$ gives us optimal poles.
close;
figure;
grid on;
hold on;

Kp = 144:0.05:150;
s_1 = (-(Kp-26)+sqrt((Kp-26).^2-4*(144+24.*Kp)))/2;
s_2 = (-(Kp-26)-sqrt((Kp-26).^2-4*(144+24.*Kp)))/2;
plot(Kp, real(s_1), 'DisplayName', 'Root 1', 'LineStyle', '-');
plot(Kp, real(s_2), 'DisplayName', 'Root 2', 'LineStyle', 'REPLACE_WITH_DASH_DASH');
xlabel('Kp'); ylabel('Real Part of Roots');
title('Optimal poles');
legend;

%%
% Verifying that Kp = 26 gives zero-poles
close;
Kp = 26;
closed_loop = (Kp*s+Kp*24)/(s^2+(Kp-26)*s+(144+24*Kp));
real(pole(closed_loop))

%%
% looking at the pole values for our new controller with $Kp = 147$
Kp = 147;
closed_loop = (Kp*s+Kp*24)/(s^2+(Kp-26)*s+(144+24*Kp));
real(pole(closed_loop))
%%
close;
pzplot(closed_loop);

%% Control system step response
% We have verified that the poles of our new system are all negative real part. This means the system stable, and we can verify this
% by viewing the step response of the closed loop system:


[y,t]=step(closed_loop); %save the output values to check steady state
SS_error = abs(1-y(end))


%%
% Thus we have verified that our control system is stable and reaches a steady state error of 3.89%
% We can also check that our simulink model agrees with our matlab simulations (see images).






##### SOURCE END #####
--></body></html>